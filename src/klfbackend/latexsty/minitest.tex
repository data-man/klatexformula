\documentclass{article}

\usepackage{xcolor}
\usepackage{amsmath}
%\usepackage{breqn}
%\usepackage{lua-visual-debug}

\usepackage[lualatex]{klfimpl}

%\klfSetTopMargin{0pt}
%\klfSetRightMargin{0pt}
%\klfSetBottomMargin{0pt}
%\klfSetLeftMargin{0pt}

%\klfSetFixedWidth{10cm}
%\klfSetFixedHeight{4cm}

\long\def\klfXXXautobreakeqn#1{%
  \setbox0=\hbox{$\displaystyle #1$}%
  \ifdim\wd0>\textwidth
    \begin{dmath*}#1\end{dmath*}\relax
  \else
    \box0\relax
  \fi
}%

\pagestyle{empty}
\begin{document}%
\begin{klfrawcontent}{\hbox}{\fontsize{50}{70}\selectfont}%
bla pla fla.%
%  pr-y%
%\hbox{x}%
%$$ \int g $$%
%$\displaystyle \mathcal{Z}$%
%\hsize=1pt\relax
%$$ h + j $$
%$$ h + j + \ell + k$$
%\[ \int \]%
%\begin{align*} \int \end{align*}%
%\begin{equation*} \int x \end{equation*}% {equation*} in amsmath
%\begin{align*} \int g+d+c \end{align*}%
%\begin{align*}
%  x_1 &= \int f dg\ ; & x_2 &= \sum z_j\ ;\\
%  z_1 &= \int x dy\ ; & z_2 &= 0 \end{align*}%
%$\displaystyle\begin{aligned} \int g+d+c \end{aligned}$%
%$\displaystyle\begin{aligned}   x_1 &= \int f dg\ ; & x_2 &= \sum z_j\ ;\\   z_1 &= \int x dy\ ; & z_2 &= 0 \end{aligned}$%
%$\displaystyle\begin{gathered}
%  x_1 = \int f dg\ ;\\
% z_2 = 0 \end{gathered}$%
%\begin{alignat*}{-1} x_1 &= \int f dg\ ; & x_2 &= \sum z_j\ ; \\
%  z_1 &= \int x dy\ ; & z_2 &= 0 \end{alignat*}%
%\begin{gather*} \int g \end{gather*}%
%\sloppy A short paragraph with some words.
%\begin{dmath*} f = a \end{dmath*}%
%\klfXXXautobreakeqn{ f = a }
%\klfXXXautobreakeqn{ f = a + b + c + d = e }
%
\end{klfrawcontent}
\end{document}
